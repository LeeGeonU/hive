{% extends "base.html" %}

{% block content %}
	{% for people in peoples %}
    	{{ people.user.username }} 
		{% if people.user.id not in followers_id_list %}
		<button followid="{{ people.user.id }}" class="followbutton btn-followbutton" method="addfollow" >
		follow!
		</button>
		{% else %}
		<button followid="{{ people.user.id }}" class="followbutton btn-followbutton" method="removefollow" >
		alreay followed!
		</button>
		{% endif %}
		</br>
		</hr>
    {% endfor %}
   <div class="pagination">
    <span class="step-links">
        {% if peoples.has_previous %}
            <a href="?page={{ peoples.previous_page_number }}{{url_search_param}}">previous</a>
        {% endif %}

        <span class="current">
            {% for i in peoples.paginator.page_range %}
                {% ifequal i peoples.number %}
                    <p>{{ i }}</p>
                {% else %}
                    <a href="/accounts/people_list/?page={{ i }}{{url_search_param}}">{{ i }}</a>
                {% endifequal %}
            {% endfor %}
        </span>

        {% if peoples.has_next %}
            <a href="?page={{ peoples.next_page_number }}{{url_search_param}}">next</a>
        {% endif %}
    </span> 
   </div> 
   
   <!-- search people text form--> 
   <form action="/accounts/people_list/" method="GET">
    	<input type="text" name="search_var">
    	<input type="submit" value="search">
   </form>
      
{% endblock %}
{% block scripts %}
<script>
{% autoescape off %}
	$(function(){
		$('.followbutton').click(function(){
			var follow_user_id = $(this).attr("followid")
			var follow_btn = $(this)
			var follow_method = $(this).attr("method")
			
			if( follow_method == "addfollow" )
				{
					follow_btn.text("already followed!")
					$(this).attr("method", "removefollow")
				}
				else
				{
					follow_btn.text("follow!")
					$(this).attr("method", "addfollow")
				}
			$.get('/accounts/'+follow_method+"/"+follow_user_id+"/", function(data) {
				window.location.reload(true)
			});			
		});
	});
{% endautoescape %}
</script>
{% endblock %}
